<!DOCTYPE html>
<html>
<head>
    <title>Tic Tac Toe - Unbeatable AI</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        .board { display: grid; grid-template-columns: repeat(3, 100px); grid-gap: 5px; margin: 20px auto; width: 310px; }
        .cell { width: 100px; height: 100px; font-size: 36px; display: flex; align-items: center; justify-content: center; background: #ddd; cursor: pointer; }
        .cell.taken { cursor: not-allowed; }
        .scoreboard { margin: 10px; font-size: 20px; }
        .button { margin-top: 10px; padding: 10px 20px; font-size: 18px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Tic Tac Toe</h1>
    <div class="scoreboard">
        Wins: <span id="wins">0</span> | Losses: <span id="losses">0</span>
    </div>
    <div class="board" id="board"></div>
    <button class="button" onclick="restartGame()">Restart</button>
    <script>
        let board = ["", "", "", "", "", "", "", "", ""];
        let human = "X", ai = "O";
        let wins = 0, losses = 0;

        function createBoard() {
            let boardDiv = document.getElementById("board");
            boardDiv.innerHTML = "";
            board.forEach((cell, i) => {
                let cellDiv = document.createElement("div");
                cellDiv.classList.add("cell");
                if (cell !== "") cellDiv.classList.add("taken");
                cellDiv.innerText = cell;
                cellDiv.addEventListener("click", () => humanMove(i));
                boardDiv.appendChild(cellDiv);
            });
        }

        function humanMove(index) {
            if (board[index] === "" && !checkWinner(board)) {
                board[index] = human;
                createBoard();
                if (!checkWinner(board)) setTimeout(aiMove, 300);
            }
        }

        function aiMove() {
            let bestMove = minimax(board, ai).index;
            board[bestMove] = ai;
            createBoard();
            checkWinner(board);
        }

        function checkWinner(b) {
            let winPatterns = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8],
                [0, 3, 6], [1, 4, 7], [2, 5, 8],
                [0, 4, 8], [2, 4, 6]
            ];
            for (let pattern of winPatterns) {
                let [a, b, c] = pattern;
                if (board[a] && board[a] === board[b] && board[a] === board[c]) {
                    setTimeout(() => {
                        alert(board[a] === human ? "You Win!" : "AI Wins!");
                        if (board[a] === human) wins++; else losses++;
                        updateScore();
                        restartGame();
                    }, 100);
                    return true;
                }
            }
            if (!board.includes("")) {
                setTimeout(() => { alert("It's a draw!"); restartGame(); }, 100);
                return true;
            }
            return false;
        }

        function updateScore() {
            document.getElementById("wins").innerText = wins;
            document.getElementById("losses").innerText = losses;
        }

        function restartGame() {
            board = ["", "", "", "", "", "", "", "", ""];
            createBoard();
        }

        function minimax(b, player) {
            let emptyCells = b.map((val, i) => (val === "" ? i : null)).filter(val => val !== null);
            if (checkWin(b, human)) return { score: -10 };
            if (checkWin(b, ai)) return { score: 10 };
            if (emptyCells.length === 0) return { score: 0 };

            let moves = [];
            for (let i of emptyCells) {
                let move = {};
                move.index = i;
                b[i] = player;
                move.score = minimax(b, player === ai ? human : ai).score;
                b[i] = "";
                moves.push(move);
            }
            return moves.reduce((best, move) =>
                (player === ai ? move.score > best.score : move.score < best.score) ? move : best, moves[0]
            );
        }

        function checkWin(b, player) {
            return [[0,1,2], [3,4,5], [6,7,8], [0,3,6], [1,4,7], [2,5,8], [0,4,8], [2,4,6]]
                .some(pattern => pattern.every(i => b[i] === player));
        }

        createBoard();
    </script>
</body>
</html>